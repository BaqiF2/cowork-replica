# Claude Replica ä»£ç é˜…è¯»æŒ‡å—

> **ç›®æ ‡å—ä¼—**: æ–°å…¥èŒå¼€å‘è€…ã€ä»£ç å®¡æŸ¥è€…ã€è´¡çŒ®è€…
> **æ›´æ–°æ—¶é—´**: 2026-01-02
> **é¢„è®¡é˜…è¯»æ—¶é•¿**: 45-60 åˆ†é’Ÿ

---

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

**Claude Replica** æ˜¯ä¸€ä¸ªå®Œæ•´å¤åˆ» Claude Code çš„æ™ºèƒ½ä»£ç åŠ©æ‰‹å‘½ä»¤è¡Œå·¥å…·,ä½¿ç”¨ Claude Agent SDK æä¾› AI è¾…åŠ©ç¼–ç¨‹èƒ½åŠ›ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **SDK é›†æˆ**: å®Œæ•´å°è£… Claude Agent SDK çš„ query() å‡½æ•°
- ğŸ”„ **ä¼šè¯ç®¡ç†**: æ”¯æŒä¼šè¯åˆ›å»ºã€ä¿å­˜ã€æ¢å¤å’Œè¿‡æœŸæ¸…ç†
- ğŸ”Œ **å¯æ‰©å±•æ¶æ„**: æŠ€èƒ½ (Skills)ã€å‘½ä»¤ (Commands)ã€ä»£ç† (Agents)ã€é’©å­ (Hooks)
- ğŸ› ï¸ **å·¥å…·ç³»ç»Ÿ**: 11 ç±»å†…ç½®å·¥å…· (æ–‡ä»¶æ“ä½œã€å‘½ä»¤æ‰§è¡Œã€æœç´¢ã€ç½‘ç»œç­‰)
- ğŸ” **æƒé™ç®¡ç†**: å¤šç§æƒé™æ¨¡å¼å’Œç»†ç²’åº¦å·¥å…·æ§åˆ¶
- ğŸ¨ **å¤šç§è¾“å‡º**: text / json / stream-json / markdown
- ğŸš€ **CI/CD æ”¯æŒ**: è‡ªåŠ¨æ£€æµ‹ CI ç¯å¢ƒå¹¶è°ƒæ•´è¡Œä¸º

### æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| è¯­è¨€ | TypeScript | 5.9+ |
| è¿è¡Œæ—¶ | Node.js | 20.0.0+ |
| æ ¸å¿ƒä¾èµ– | @anthropic-ai/claude-agent-sdk | ^0.1.76 |
| ç»ˆç«¯æ¨¡æ‹Ÿ | node-pty | ^1.1.0 |
| æµ‹è¯•æ¡†æ¶ | Jest | 29+ |
| å±æ€§æµ‹è¯• | fast-check | ^3.23.2 |
| æ„å»ºå·¥å…· | TypeScript Compiler | - |
| ä»£ç è´¨é‡ | ESLint + Prettier | - |

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„æ¨¡å¼

Claude Replica é‡‡ç”¨ **åˆ†å±‚æ¶æ„ + ç®¡ç†å™¨æ¨¡å¼**ï¼Œå„å±‚èŒè´£æ¸…æ™°ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥å®ç°æ¾è€¦åˆã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLI å±‚ (Entry)                          â”‚
â”‚  cli.ts â†’ CLIParser â†’ å‚æ•°è§£æ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åº”ç”¨å±‚ (Orchestration)                       â”‚
â”‚  main.ts â†’ Application ç±» â†’ åˆå§‹åŒ–æ‰€æœ‰ç®¡ç†å™¨                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ ¸å¿ƒå±‚ (Core Logic)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ MessageRouter  â”‚â†’ â”‚ SessionManager  â”‚  â”‚ Streaming    â”‚ â”‚
â”‚  â”‚ æ¶ˆæ¯è·¯ç”±        â”‚  â”‚ ä¼šè¯ç®¡ç†         â”‚  â”‚ Processor    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 SDK é›†æˆå±‚ (SDK Integration)                 â”‚
â”‚  SDKQueryExecutor â†’ å°è£… Claude Agent SDK                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æ‰©å±•ç³»ç»Ÿå±‚ (Extension Systems)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Skills   â”‚ â”‚ Commands â”‚ â”‚ Agents   â”‚ â”‚ Hooks    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚  â”‚   MCP    â”‚  Model Context Protocol é›†æˆ                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ”¯æ’‘å±‚ (Infrastructure)                      â”‚
â”‚  Config | Permissions | Tools | Security | Output | CI      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è®¾è®¡æ¨¡å¼

1. **ç®¡ç†å™¨æ¨¡å¼** (Manager Pattern)
   - æ¯ä¸ªå­ç³»ç»Ÿç”±ç‹¬ç«‹çš„ Manager ç±»ç®¡ç†
   - ç»Ÿä¸€çš„åˆå§‹åŒ–ã€åŠ è½½ã€æ¸…ç†æ¥å£

2. **é€‚é…å™¨æ¨¡å¼** (Adapter Pattern)
   - `SDKQueryExecutor`: å†…éƒ¨é€‰é¡¹ â†’ SDK Options
   - `MessageRouter`: ä¼šè¯ä¸Šä¸‹æ–‡ â†’ SDK ç³»ç»Ÿæç¤ºè¯

3. **ç­–ç•¥æ¨¡å¼** (Strategy Pattern)
   - `OutputFormatter`: å¤šç§è¾“å‡ºæ ¼å¼
   - `PermissionManager`: ä¸åŒæƒé™æ¨¡å¼

---

## ğŸ“š åˆ†å±‚é˜…è¯»è·¯å¾„

### ğŸ¯ æ¨èé˜…è¯»é¡ºåº

æŒ‰ç…§ **ä»ä¸Šå±‚åˆ°åº•å±‚ã€ä»å…¥å£åˆ°å®ç°** çš„é¡ºåºé˜…è¯»,æ¯å±‚ç†è§£é€å½»åå†è¿›å…¥ä¸‹ä¸€å±‚ã€‚

---

## ç¬¬ä¸€å±‚: CLI å…¥å£å±‚ (5 åˆ†é’Ÿ)

**ç›®æ ‡**: ç†è§£ç¨‹åºå¦‚ä½•å¯åŠ¨å’Œå‚æ•°å¦‚ä½•è§£æ

### æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | èŒè´£ | å…³é”®ç‚¹ |
|------|------|--------|
| `src/cli.ts` | CLI å…¥å£ç‚¹ | npm bin å…¥å£,å§”æ‰˜ç»™ main.ts |
| `src/cli/CLIParser.ts` | å‘½ä»¤è¡Œå‚æ•°è§£æ | æ”¯æŒ --help, --version, -p, --model ç­‰ 20+ é€‰é¡¹ |

### é˜…è¯»è¦ç‚¹

1. **cli.ts**:
   - å¦‚ä½•è°ƒç”¨ `main()` å‡½æ•°
   - é”™è¯¯å¤„ç†å’Œé€€å‡ºç 

2. **CLIParser.ts**:
   - æ”¯æŒçš„å‘½ä»¤è¡Œé€‰é¡¹åˆ—è¡¨
   - å‚æ•°éªŒè¯é€»è¾‘
   - `CLIOptions` æ¥å£å®šä¹‰

### ä»£ç è¿½è¸ª

```typescript
// 1. ç”¨æˆ·æ‰§è¡Œå‘½ä»¤
$ claude-replica -p "å¸®æˆ‘ä¿®å¤è¿™ä¸ª bug"

// 2. cli.ts (å…¥å£ç‚¹)
main(process.argv.slice(2))
  .then(exitCode => process.exit(exitCode))

// 3. CLIParser è§£æå‚æ•°
const options = cliParser.parse(args)
// â†’ { prompt: "å¸®æˆ‘ä¿®å¤è¿™ä¸ª bug", ... }
```

---

## ç¬¬äºŒå±‚: åº”ç”¨ç¼–æ’å±‚ (15 åˆ†é’Ÿ)

**ç›®æ ‡**: æŒæ¡åº”ç”¨åˆå§‹åŒ–æµç¨‹å’Œå„å­ç³»ç»Ÿåä½œå…³ç³»

### æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | èŒè´£ | å…³é”®ç±»/æ–¹æ³• |
|------|------|------------|
| `src/main.ts` | åº”ç”¨ä¸»ç¨‹åº | `Application` ç±»,`run()`, `initialize()` |

### é˜…è¯»è¦ç‚¹

1. **Application ç±»æ„é€ å‡½æ•°** (198-211 è¡Œ)
   - åˆå§‹åŒ–æ‰€æœ‰ç®¡ç†å™¨å®ä¾‹
   - ä¾èµ–æ³¨å…¥å…³ç³»å›¾

2. **initialize() æ–¹æ³•** (295-336 è¡Œ)
   - é…ç½®åŠ è½½é¡ºåº: User â†’ Project â†’ Local
   - æ‰©å±•ç³»ç»ŸåŠ è½½: Skills, Commands, Agents, Hooks
   - MCP æœåŠ¡å™¨é…ç½®åŠ è½½

3. **è¿è¡Œæ¨¡å¼** (216-266 è¡Œ)
   - **äº¤äº’æ¨¡å¼**: `runInteractive()` â†’ UI å¾ªç¯
   - **éäº¤äº’æ¨¡å¼**: `runNonInteractive()` â†’ å•æ¬¡æŸ¥è¯¢

4. **å…³é”®æ–¹æ³•**:
   - `getOrCreateSession()`: ä¼šè¯åˆ›å»º/æ¢å¤é€»è¾‘
   - `executeQuery()`: æ ¸å¿ƒæŸ¥è¯¢æ‰§è¡Œæµç¨‹
   - `handleInterrupt()`: ä¸­æ–­å¤„ç† (Ctrl+C)

### ä¾èµ–å…³ç³»å›¾

```
Application
  â”œâ”€â”€ CLIParser          (å‚æ•°è§£æ)
  â”œâ”€â”€ ConfigManager      (é…ç½®ç®¡ç†)
  â”œâ”€â”€ SessionManager     (ä¼šè¯ç®¡ç†)
  â”œâ”€â”€ ToolRegistry       (å·¥å…·æ³¨å†Œ)
  â”œâ”€â”€ SkillManager       (æŠ€èƒ½åŠ è½½)
  â”œâ”€â”€ CommandManager     (å‘½ä»¤æ¨¡æ¿)
  â”œâ”€â”€ AgentRegistry      (å­ä»£ç†)
  â”œâ”€â”€ HookManager        (äº‹ä»¶é’©å­)
  â”œâ”€â”€ MCPManager         (MCP æœåŠ¡å™¨)
  â”œâ”€â”€ PermissionManager  (æƒé™æ§åˆ¶)
  â”œâ”€â”€ MessageRouter      (æ¶ˆæ¯è·¯ç”±)
  â”œâ”€â”€ SDKQueryExecutor   (SDK æ‰§è¡Œ)
  â”œâ”€â”€ RewindManager      (æ—¶é—´å›é€€)
  â”œâ”€â”€ SecurityManager    (å®‰å…¨æ£€æŸ¥)
  â”œâ”€â”€ OutputFormatter    (è¾“å‡ºæ ¼å¼åŒ–)
  â””â”€â”€ CISupport          (CI/CD æ”¯æŒ)
```

### ä»£ç è¿½è¸ª: æŸ¥è¯¢æ‰§è¡Œæµç¨‹

```typescript
// ç”¨æˆ·å‘é€æ¶ˆæ¯
handleUserMessage(message, session)
  â†“
// æ‰§è¡ŒæŸ¥è¯¢
executeQuery(prompt, session, options)
  â†“
// è·¯ç”±æ¶ˆæ¯ â†’ æ„å»ºç³»ç»Ÿæç¤ºè¯å’Œå·¥å…·åˆ—è¡¨
messageRouter.routeMessage(message, session)
  â†“
// è°ƒç”¨ SDK æ‰§è¡Œ
sdkExecutor.execute({ prompt, model, systemPrompt, ... })
  â†“
// ä¿å­˜å“åº”åˆ°ä¼šè¯
sessionManager.addMessage(session, { role: 'assistant', content })
```

---

## ç¬¬ä¸‰å±‚: æ ¸å¿ƒä¸šåŠ¡å±‚ (20 åˆ†é’Ÿ)

**ç›®æ ‡**: ç†è§£æ¶ˆæ¯è·¯ç”±ã€ä¼šè¯ç®¡ç†å’Œæµå¼å¤„ç†çš„æ ¸å¿ƒé€»è¾‘

### 3.1 æ¶ˆæ¯è·¯ç”± (`src/core/MessageRouter.ts`)

**æ ¸å¿ƒèŒè´£**:
- æ„å»ºç³»ç»Ÿæç¤ºè¯ (CLAUDE.md + Skills)
- è·å–å¯ç”¨çš„å·¥å…·åˆ—è¡¨
- åˆ›å»ºæƒé™å¤„ç†å‡½æ•°
- ç»„è£… SDK æŸ¥è¯¢é€‰é¡¹

**å…³é”®æ–¹æ³•**:

| æ–¹æ³• | èŒè´£ | è¡Œæ•° |
|------|------|------|
| `routeMessage()` | è·¯ç”±æ¶ˆæ¯åˆ° SDK | 129-140 |
| `buildSystemPrompt()` | æ„å»ºç³»ç»Ÿæç¤ºè¯ | 155-191 |
| `getEnabledToolNames()` | è·å–å¯ç”¨çš„å·¥å…· | 204-231 |
| `createPermissionHandler()` | åˆ›å»ºæƒé™å‡½æ•° | 241-258 |
| `buildQueryOptions()` | æ„å»ºæŸ¥è¯¢é€‰é¡¹ | 302-343 |

**é˜…è¯»è¦ç‚¹**:
1. ç³»ç»Ÿæç¤ºè¯ç»„åˆé¡ºåº: CLAUDE.md â†’ Skills â†’ é»˜è®¤æŒ‡ä»¤ â†’ è¿½åŠ æç¤º
2. å·¥å…·å¯ç”¨é€»è¾‘: åŸºç¡€å·¥å…· + æŠ€èƒ½å·¥å…· - ç¦ç”¨å·¥å…·
3. æƒé™å¤„ç†å‡½æ•°å¦‚ä½•åŒ…è£… `PermissionManager`

### 3.2 ä¼šè¯ç®¡ç† (`src/core/SessionManager.ts`)

**æ ¸å¿ƒèŒè´£**:
- åˆ›å»ºå’ŒæŒä¹…åŒ–ä¼šè¯
- åŠ è½½å’Œæ¢å¤ä¼šè¯
- ä¼šè¯è¿‡æœŸç®¡ç† (5 å°æ—¶)
- SDK ä¼šè¯ ID ç®¡ç†

**ä¼šè¯å­˜å‚¨ç»“æ„**:
```
~/.claude-replica/sessions/session-{timestamp}-{id}/
â”œâ”€â”€ metadata.json     # id, æ—¶é—´æˆ³, sdkSessionId
â”œâ”€â”€ messages.json     # å¯¹è¯å†å² (å« usage ç»Ÿè®¡)
â”œâ”€â”€ context.json      # æŠ€èƒ½ã€ä»£ç†ã€é…ç½®
â””â”€â”€ snapshots/        # Rewind å¿«ç…§
```

**å…³é”®æ–¹æ³•**:

| æ–¹æ³• | èŒè´£ |
|------|------|
| `createSession()` | åˆ›å»ºæ–°ä¼šè¯ |
| `saveSession()` | æŒä¹…åŒ–ä¼šè¯åˆ°ç£ç›˜ |
| `loadSession()` | ä»ç£ç›˜åŠ è½½ä¼šè¯ |
| `addMessage()` | æ·»åŠ æ¶ˆæ¯åˆ°ä¼šè¯ |
| `cleanExpiredSessions()` | æ¸…ç†è¿‡æœŸä¼šè¯ |

**é˜…è¯»è¦ç‚¹**:
1. ä¼šè¯ ID ç”Ÿæˆ: `crypto.randomBytes(16).toString('hex')`
2. è¿‡æœŸé€»è¾‘: `expiresAt = createdAt + 5 å°æ—¶`
3. SDK ä¼šè¯ ID çš„ä½œç”¨: æ¢å¤å†å²æ¶ˆæ¯ä¸Šä¸‹æ–‡

### 3.3 æµå¼æ¶ˆæ¯å¤„ç† (`src/core/StreamingMessageProcessor.ts`)

**æ ¸å¿ƒèŒè´£**:
- å¤„ç† SDK è¿”å›çš„æµå¼æ¶ˆæ¯
- è¯†åˆ«æ¶ˆæ¯ç±»å‹ (assistant, result, tool_use)
- ç´¯ç§¯æ–‡æœ¬å†…å®¹

---

## ç¬¬å››å±‚: SDK é›†æˆå±‚ (10 åˆ†é’Ÿ)

**ç›®æ ‡**: ç†è§£å¦‚ä½•å°è£…å’Œè°ƒç”¨ Claude Agent SDK

### æ ¸å¿ƒæ–‡ä»¶: `src/sdk/SDKQueryExecutor.ts`

**æ ¸å¿ƒèŒè´£**:
1. æ˜ å°„å†…éƒ¨é€‰é¡¹åˆ° SDK `Options` æ ¼å¼
2. è°ƒç”¨ SDK `query()` å‡½æ•°
3. å¤„ç†å¼‚æ­¥ç”Ÿæˆå™¨æµ
4. é”™è¯¯åˆ†ç±»å’Œå¤„ç† (ç½‘ç»œã€è®¤è¯ã€é€Ÿç‡é™åˆ¶ã€è¶…æ—¶ã€ä¸­æ–­)
5. ä¸­æ–­æ”¯æŒ (AbortController)

**å…³é”®æ–¹æ³•**:

| æ–¹æ³• | èŒè´£ | éªŒè¯éœ€æ±‚ |
|------|------|----------|
| `execute()` | æ‰§è¡Œ SDK æŸ¥è¯¢ | 1.1, 1.3, 4.1-4.3 |
| `mapToSDKOptions()` | é€‰é¡¹æ˜ å°„ | 1.2, 6.1-6.5 |
| `processMessage()` | å¤„ç†å•ä¸ªæ¶ˆæ¯ | 2.2 |
| `interrupt()` | ä¸­æ–­å½“å‰æŸ¥è¯¢ | 4.1, 4.2 |

**é”™è¯¯åˆ†ç±»ç³»ç»Ÿ**:

```typescript
enum SDKErrorType {
  NETWORK,         // ç½‘ç»œé”™è¯¯ (ENOTFOUND, ECONNREFUSED)
  AUTHENTICATION,  // è®¤è¯é”™è¯¯ (401, 403)
  RATE_LIMIT,      // é€Ÿç‡é™åˆ¶ (429)
  TIMEOUT,         // è¶…æ—¶é”™è¯¯
  INTERRUPTED,     // ç”¨æˆ·ä¸­æ–­
  UNKNOWN          // æœªçŸ¥é”™è¯¯
}
```

**é˜…è¯»è¦ç‚¹**:
1. **ä¸­æ–­æœºåˆ¶**: ä½¿ç”¨ `AbortController` å®ç° Ctrl+C ä¸­æ–­
2. **æ¶ˆæ¯æµå¤„ç†**: `for await (const message of queryGenerator)`
3. **Token ç»Ÿè®¡**: ä» `result` æ¶ˆæ¯ä¸­æå– `usage` ä¿¡æ¯
4. **ä¼šè¯æ¢å¤**: `resume` å‚æ•°ä¼ é€’ SDK ä¼šè¯ ID

**ä»£ç è¿½è¸ª: SDK æŸ¥è¯¢æµç¨‹**

```typescript
// 1. æ‰§è¡ŒæŸ¥è¯¢
sdkExecutor.execute(options)
  â†“
// 2. æ˜ å°„é€‰é¡¹
const sdkOptions = mapToSDKOptions(options)
  â†“
// 3. è°ƒç”¨ SDK
const generator = query({ prompt, options: sdkOptions })
  â†“
// 4. è¿­ä»£æ¶ˆæ¯æµ
for await (const message of generator) {
  if (message.type === 'assistant') {
    // ç´¯ç§¯å“åº”æ–‡æœ¬
  } else if (message.type === 'result') {
    // æå– usage ç»Ÿè®¡
    return { response, usage, totalCostUsd }
  }
}
```

---

## ç¬¬äº”å±‚: æ‰©å±•ç³»ç»Ÿå±‚ (15 åˆ†é’Ÿ)

**ç›®æ ‡**: ç†è§£å››å¤§æ‰©å±•ç³»ç»Ÿçš„åŠ è½½æœºåˆ¶å’Œä½œç”¨

### 5.1 æŠ€èƒ½ç³»ç»Ÿ (`src/skills/SkillManager.ts`)

**ä½œç”¨**: æ³¨å…¥é¢†åŸŸçŸ¥è¯†å’Œå·¥ä½œæµç¨‹åˆ°ç³»ç»Ÿæç¤ºè¯

**æ–‡ä»¶æ ¼å¼**:
```markdown
---
name: my-skill
description: æŠ€èƒ½æè¿°
triggers: [å…³é”®è¯1, å…³é”®è¯2]
tools: [Read, Write]
---

æŠ€èƒ½å†…å®¹ (Markdown)
```

**åŠ è½½è·¯å¾„**:
- `~/.claude-replica/skills/` (ç”¨æˆ·çº§)
- `.claude-replica/skills/` (é¡¹ç›®çº§)

**æ ¸å¿ƒæ–¹æ³•**:
- `loadSkills()`: ä»ç›®å½•åŠ è½½æ‰€æœ‰æŠ€èƒ½
- `parseSkillFile()`: è§£æ YAML frontmatter

### 5.2 å‘½ä»¤ç³»ç»Ÿ (`src/commands/CommandManager.ts`)

**ä½œç”¨**: æä¾›å¯å¤ç”¨çš„å‘½ä»¤æ¨¡æ¿

**æ–‡ä»¶æ ¼å¼**:
```markdown
---
name: my-command
description: å‘½ä»¤æè¿°
allowedTools: [Bash, Read]
---

å‘½ä»¤å†…å®¹,æ”¯æŒå˜é‡: $ARGUMENTS
```

**è°ƒç”¨æ–¹å¼**: `/user:command` æˆ– `/project:command`

### 5.3 ä»£ç†ç³»ç»Ÿ (`src/agents/AgentRegistry.ts`)

**ä½œç”¨**: æ³¨å†Œå­ä»£ç†ç”¨äºä¸“é—¨ä»»åŠ¡

**æ–‡ä»¶æ ¼å¼**:
```markdown
---
name: my-agent
description: ä»£ç†æè¿°
model: sonnet | opus | haiku | inherit
tools: [Read, Grep]
---

ä»£ç†æç¤ºè¯å†…å®¹
```

**SDK é›†æˆ**: è½¬æ¢ä¸º SDK çš„ `AgentDefinition[]`

### 5.4 é’©å­ç³»ç»Ÿ (`src/hooks/HookManager.ts`)

**ä½œç”¨**: äº‹ä»¶é©±åŠ¨çš„è‡ªåŠ¨åŒ–

**é…ç½®æ–‡ä»¶**: `.claude-replica/hooks.json`

**æ”¯æŒçš„äº‹ä»¶** (12 ç§):
- PreToolUse / PostToolUse
- SessionStart / SessionEnd
- UserPromptSubmit
- MessageStreaming
- ...

**é’©å­åŠ¨ä½œ**:
- æ‰§è¡Œå‘½ä»¤
- æ³¨å…¥æç¤ºè¯

### 5.5 MCP é›†æˆ (`src/mcp/MCPManager.ts`)

**ä½œç”¨**: Model Context Protocol æœåŠ¡å™¨ç®¡ç†

**é…ç½®æ–‡ä»¶**: `.mcp.json` æˆ– `mcp.json`

**ä¼ è¾“æ–¹å¼**:
- stdio (å‘½ä»¤ + å‚æ•°)
- SSE (HTTP æµå¼)
- HTTP (REST API)

---

## ç¬¬å…­å±‚: æ”¯æ’‘ç³»ç»Ÿå±‚ (10 åˆ†é’Ÿ)

### 6.1 é…ç½®ç®¡ç† (`src/config/ConfigManager.ts`)

**é…ç½®å±‚çº§** (ä¼˜å…ˆçº§: Local > Project > User):
1. User: `~/.claude-replica/settings.json`
2. Project: `.claude-replica/settings.json`
3. Local: `.claude-replica/settings.local.json`

**åˆå¹¶ç­–ç•¥**: `mergeConfigs()` æ·±åº¦åˆå¹¶

### 6.2 æƒé™ç®¡ç† (`src/permissions/PermissionManager.ts`)

**æƒé™æ¨¡å¼**:
- `default`: äº¤äº’å¼ç¡®è®¤
- `acceptEdits`: è‡ªåŠ¨æ¥å—ç¼–è¾‘æ“ä½œ
- `bypassPermissions`: è·³è¿‡æ‰€æœ‰æƒé™æ£€æŸ¥
- `plan`: è®¡åˆ’æ¨¡å¼ (åªè¯»å·¥å…·)

**æƒé™æ£€æŸ¥æµç¨‹**:
```typescript
canUseTool(params) {
  1. æ£€æŸ¥ disallowedTools é»‘åå•
  2. æ£€æŸ¥ allowedTools ç™½åå•
  3. æ£€æŸ¥ bypass æ ‡å¿—
  4. æ£€æŸ¥ Bash å‘½ä»¤è¿‡æ»¤
  5. æç¤ºç”¨æˆ·ç¡®è®¤ (if needed)
}
```

### 6.3 å·¥å…·æ³¨å†Œè¡¨ (`src/tools/ToolRegistry.ts`)

**11 ç±»å·¥å…·**:
- æ–‡ä»¶æ“ä½œ: Read, Write, Edit
- å‘½ä»¤æ‰§è¡Œ: Bash, BashOutput, KillBash
- æœç´¢: Grep, Glob
- ç”¨æˆ·äº¤äº’: AskUserQuestion
- ç½‘ç»œ: WebFetch, WebSearch
- ä»»åŠ¡: Task, TodoWrite
- Jupyter: NotebookEdit
- è®¡åˆ’: ExitPlanMode
- MCP: ListMcpResources, ReadMcpResource

### 6.4 å®‰å…¨ç®¡ç† (`src/security/SecurityManager.ts`)

**åŠŸèƒ½**:
- æ£€æµ‹æ•æ„Ÿæ•°æ® (API å¯†é’¥ã€å¯†ç ã€Token)
- è¯†åˆ«å±é™©å‘½ä»¤ (`rm -rf`, `dd`, `mkfs`)
- æ—¥å¿—è„±æ•
- ç¡®è®¤ç ´åæ€§æ“ä½œ

### 6.5 è¾“å‡ºæ ¼å¼åŒ– (`src/output/OutputFormatter.ts`)

**æ”¯æŒæ ¼å¼**:
- `text`: çº¯æ–‡æœ¬
- `json`: ç»“æ„åŒ– JSON
- `stream-json`: æµå¼ JSON
- `markdown`: Markdown æ ¼å¼

### 6.6 CI/CD æ”¯æŒ (`src/ci/CISupport.ts`)

**åŠŸèƒ½**:
- è‡ªåŠ¨æ£€æµ‹ CI ç¯å¢ƒ (GitHub Actions, GitLab, Jenkins, etc.)
- ç»“æ„åŒ–æ—¥å¿—
- è¶…æ—¶ç®¡ç†
- é€€å‡ºç æ˜ å°„

---

## ğŸ” æ ¸å¿ƒä¸šåŠ¡æµç¨‹è¿½è¸ª

### æµç¨‹ 1: éäº¤äº’æ¨¡å¼æŸ¥è¯¢æ‰§è¡Œ

```
ç”¨æˆ·å‘½ä»¤: claude-replica -p "åˆ†æè¿™ä¸ªé¡¹ç›®"
  â†“
1. cli.ts â†’ main()
  â†“
2. CLIParser.parse() â†’ { prompt: "åˆ†æè¿™ä¸ªé¡¹ç›®", ... }
  â†“
3. Application.initialize()
   - åŠ è½½é…ç½® (User + Project + Local)
   - åˆå§‹åŒ–ç®¡ç†å™¨ (Session, Tool, Permission, ...)
   - åŠ è½½æ‰©å±• (Skills, Commands, Agents, Hooks)
   - åŠ è½½ MCP æœåŠ¡å™¨
  â†“
4. Application.runNonInteractive()
   â”œâ”€ getOrCreateSession() â†’ åˆ›å»ºæ–°ä¼šè¯
   â”œâ”€ ciSupport.startExecution() â†’ å¯åŠ¨è¶…æ—¶è®¡æ—¶
   â””â”€ executeQuery(prompt, session)
      â†“
5. executeQuery() æ ¸å¿ƒæµç¨‹
   â”œâ”€ sessionManager.addMessage() â†’ ä¿å­˜ç”¨æˆ·æ¶ˆæ¯
   â”œâ”€ messageRouter.routeMessage()
   â”‚  â”œâ”€ buildSystemPrompt() â†’ CLAUDE.md + Skills
   â”‚  â”œâ”€ getEnabledToolNames() â†’ å·¥å…·åˆ—è¡¨
   â”‚  â”œâ”€ createPermissionHandler() â†’ æƒé™å‡½æ•°
   â”‚  â””â”€ buildQueryOptions() â†’ SDK é€‰é¡¹
   â†“
6. sdkExecutor.execute()
   â”œâ”€ mapToSDKOptions() â†’ è½¬æ¢é€‰é¡¹æ ¼å¼
   â”œâ”€ query({ prompt, options }) â†’ è°ƒç”¨ SDK
   â”œâ”€ for await (message of generator)
   â”‚  â”œâ”€ ç´¯ç§¯ assistant æ¶ˆæ¯
   â”‚  â””â”€ æå– result æ¶ˆæ¯ç»Ÿè®¡
   â†“
7. å¤„ç†ç»“æœ
   â”œâ”€ sessionManager.addMessage() â†’ ä¿å­˜åŠ©æ‰‹å“åº” (å« usage)
   â”œâ”€ outputFormatter.format() â†’ æ ¼å¼åŒ–è¾“å‡º
   â””â”€ ciSupport.endExecution() â†’ ç»“æŸè®¡æ—¶
   â†“
8. è¿”å›é€€å‡ºç  â†’ process.exit()
```

### æµç¨‹ 2: äº¤äº’æ¨¡å¼å¾ªç¯

```
ç”¨æˆ·å¯åŠ¨: claude-replica
  â†“
1. Application.runInteractive()
   â”œâ”€ getOrCreateSession()
   â””â”€ new InteractiveUI({ onMessage, onInterrupt, onRewind })
      â†“
2. UI.start() â†’ è¿›å…¥äº¤äº’å¾ªç¯
   â†“
3. ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
   â†“
4. handleUserMessage(message, session)
   â”œâ”€ æ£€æŸ¥æ˜¯å¦æ˜¯å‘½ä»¤ (/help, /sessions, etc.)
   â””â”€ executeQuery(message, session)
      â†“
5. SDK æŸ¥è¯¢ (åŒæµç¨‹ 1 çš„æ­¥éª¤ 5-6)
   â†“
6. UI.displayMessage(result, 'assistant')
   â†“
7. ç­‰å¾…ä¸‹ä¸€æ¡ç”¨æˆ·è¾“å…¥ (å¾ªç¯åˆ°æ­¥éª¤ 3)
```

### æµç¨‹ 3: ä¸­æ–­å¤„ç† (Ctrl+C)

```
ç”¨æˆ·æŒ‰ Ctrl+C
  â†“
1. UI.onInterrupt() å›è°ƒè§¦å‘
   â†“
2. Application.handleInterrupt()
   â”œâ”€ currentAbortController.abort() â†’ ä¸­æ­¢ SDK æŸ¥è¯¢
   â”œâ”€ sdkExecutor.interrupt() â†’ æ ‡è®°ä¸­æ–­çŠ¶æ€
   â””â”€ UI.displayWarning("æ“ä½œå·²ä¸­æ–­")
   â†“
3. SDKQueryExecutor.execute()
   â”œâ”€ æ£€æµ‹ abortController.signal.aborted
   â””â”€ è¿”å› { isError: true, errorMessage: "æ“ä½œå·²ä¸­æ–­" }
   â†“
4. ç”¨æˆ·å¯ç»§ç»­è¾“å…¥æ–°æ¶ˆæ¯
```

### æµç¨‹ 4: ä¼šè¯æ¢å¤

```
ç”¨æˆ·å‘½ä»¤: claude-replica --resume session-123
  â†“
1. getOrCreateSession({ resume: "session-123" })
   â”œâ”€ sessionManager.loadSession("session-123")
   â”‚  â”œâ”€ è¯»å– metadata.json â†’ è·å– sdkSessionId
   â”‚  â”œâ”€ è¯»å– messages.json â†’ æ¢å¤å¯¹è¯å†å²
   â”‚  â””â”€ è¯»å– context.json â†’ æ¢å¤æŠ€èƒ½/ä»£ç†/é…ç½®
   â†“
2. executeQuery(prompt, session)
   â”œâ”€ SDK options åŒ…å« resume: session.sdkSessionId
   â””â”€ SDK è‡ªåŠ¨æ¢å¤å†å²æ¶ˆæ¯ä¸Šä¸‹æ–‡
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### è®¾è®¡æ¨¡å¼åº”ç”¨

1. **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ª Manager åªè´Ÿè´£ä¸€ä¸ªå­ç³»ç»Ÿ
2. **ä¾èµ–æ³¨å…¥**: Application é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–
3. **æ¥å£éš”ç¦»**: å„å±‚é€šè¿‡æ¸…æ™°çš„æ¥å£é€šä¿¡
4. **å¼€é—­åŸåˆ™**: é€šè¿‡æ‰©å±•ç³»ç»Ÿ (Skills/Commands/Agents) å®ç°åŠŸèƒ½æ‰©å±•

### å…³é”®é›†æˆç‚¹ (Choke Points)

ä¿®æ”¹ä»£ç æ—¶,ç†è§£è¿™äº›å…³é”®é›†æˆç‚¹è‡³å…³é‡è¦:

| é›†æˆç‚¹ | ä½ç½® | ä½œç”¨ |
|--------|------|------|
| **æ‰€æœ‰ SDK æŸ¥è¯¢** | `SDKQueryExecutor.execute()` | å”¯ä¸€çš„ SDK è°ƒç”¨å…¥å£ |
| **æ‰€æœ‰é…ç½®** | `ConfigManager.mergeConfigs()` | é…ç½®åˆå¹¶é€»è¾‘ |
| **æ‰€æœ‰æƒé™** | `PermissionManager.createCanUseToolHandler()` | æƒé™æ£€æŸ¥å…¥å£ |
| **æ‰€æœ‰ç³»ç»Ÿæç¤º** | `MessageRouter.buildSystemPrompt()` | ç³»ç»Ÿæç¤ºè¯æ„å»º |
| **æ‰€æœ‰è¾“å‡º** | `OutputFormatter.format()` | è¾“å‡ºæ ¼å¼åŒ– |
| **æ‰€æœ‰äº‹ä»¶** | `HookManager.executeHooks()` | äº‹ä»¶é’©å­è§¦å‘ |

### æ€§èƒ½ä¼˜åŒ–ç‚¹

1. **ä¼šè¯æ–‡ä»¶ I/O**: æ¯æ¬¡æ¶ˆæ¯éƒ½ä¼šä¿å­˜ä¼šè¯ (`saveSession()`)
2. **æŠ€èƒ½åŠ è½½**: å¯åŠ¨æ—¶åŒæ­¥åŠ è½½æ‰€æœ‰æŠ€èƒ½æ–‡ä»¶
3. **å·¥å…·æ³¨å†Œ**: ToolRegistry åœ¨æ„é€ æ—¶åˆå§‹åŒ–æ‰€æœ‰å·¥å…·å®šä¹‰
4. **æµå¼å¤„ç†**: SDK æ¶ˆæ¯æµå¯èƒ½åŒ…å«å¤§é‡å·¥å…·è°ƒç”¨æ¶ˆæ¯

### æ½œåœ¨é£é™©ç‚¹

1. **ä¼šè¯æ–‡ä»¶æŸå**:
   - é—®é¢˜: JSON è§£æå¤±è´¥å¯¼è‡´ä¼šè¯æ— æ³•åŠ è½½
   - ç¼“è§£: æ·»åŠ  schema éªŒè¯ (ä½¿ç”¨ ajv)

2. **SDK ä¼šè¯ ID ä¸ä¸€è‡´**:
   - é—®é¢˜: SDK è¿”å›çš„ session_id ä¸æœ¬åœ°ä¼šè¯ ID ä¸åŒ¹é…
   - ç¼“è§£: åˆ†åˆ«å­˜å‚¨ `session.id` å’Œ `session.sdkSessionId`

3. **æƒé™ç»•è¿‡**:
   - é—®é¢˜: `bypassPermissions` æ¨¡å¼å¯èƒ½æ‰§è¡Œå±é™©å‘½ä»¤
   - ç¼“è§£: SecurityManager æ£€æµ‹å±é™©å‘½ä»¤å¹¶äºŒæ¬¡ç¡®è®¤

4. **ä¸­æ–­æ—¶æœº**:
   - é—®é¢˜: SDK æŸ¥è¯¢è¿‡ç¨‹ä¸­ä¸­æ–­å¯èƒ½å¯¼è‡´éƒ¨åˆ†å“åº”ä¸¢å¤±
   - ç¼“è§£: ä¸­æ–­æ—¶ä¿å­˜å·²ç´¯ç§¯çš„å“åº”

---

## ğŸ§ª æµ‹è¯•æ¶æ„

### æµ‹è¯•ç»„ç»‡

```
tests/
â”œâ”€â”€ unit/           # å•å…ƒæµ‹è¯• (å„ç®¡ç†å™¨ç±»)
â”œâ”€â”€ integration/    # é›†æˆæµ‹è¯• (å¤šæ¨¡å—åä½œ)
â”œâ”€â”€ terminal/       # ç»ˆç«¯æ¨¡æ‹Ÿæµ‹è¯• (node-pty)
â”œâ”€â”€ testing/        # æµ‹è¯•æ¡†æ¶è‡ªèº«æµ‹è¯•
â””â”€â”€ *.property.test.ts  # å±æ€§æµ‹è¯• (fast-check)
```

### è¿è¡Œæµ‹è¯•

```bash
# æ‰€æœ‰æµ‹è¯•
npm test

# ç»ˆç«¯æµ‹è¯• (30s è¶…æ—¶)
npm run test:terminal

# å±æ€§æµ‹è¯• (60s è¶…æ—¶)
npm run test:property

# è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

---

## ğŸ“– å¸¸è§é—®é¢˜ FAQ

### Q1: å¦‚ä½•æ·»åŠ æ–°å·¥å…·?

1. åœ¨ `src/tools/ToolRegistry.ts` å®šä¹‰å·¥å…·å…ƒæ•°æ®
2. å®ç°å·¥å…·æ‰§è¡Œå™¨ (å¯é€‰,SDK å†…ç½®å·¥å…·æ— éœ€å®ç°)
3. æ³¨å†Œåˆ° `ToolRegistry.getAllTools()`
4. æ·»åŠ æƒé™è§„åˆ™ (å¦‚æœæ˜¯å±é™©å·¥å…·)

### Q2: å¦‚ä½•ä¿®æ”¹ SDK é›†æˆé€»è¾‘?

**åªä¿®æ”¹è¿™ä¸¤ä¸ªæ–‡ä»¶**:
- `src/sdk/SDKQueryExecutor.ts` (SDK è°ƒç”¨å°è£…)
- `src/core/MessageRouter.ts` (é€‰é¡¹æ„å»º)

### Q3: ä¼šè¯æ–‡ä»¶å­˜å‚¨åœ¨å“ªé‡Œ?

```
~/.claude-replica/sessions/session-{timestamp}-{id}/
â”œâ”€â”€ metadata.json
â”œâ”€â”€ messages.json
â”œâ”€â”€ context.json
â””â”€â”€ snapshots/
```

### Q4: å¦‚ä½•è°ƒè¯• SDK æŸ¥è¯¢?

è®¾ç½®ç¯å¢ƒå˜é‡:
```bash
export DEBUG_MODE=true
npm run start
```

æŸ¥çœ‹æ—¥å¿—:
```
~/.claude-replica/logs/claude-replica-{timestamp}.log
```

### Q5: æŠ€èƒ½å¦‚ä½•æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºè¯?

```
systemPrompt = CLAUDE.md + Skills + é»˜è®¤æŒ‡ä»¤ + è¿½åŠ æç¤º

# MessageRouter.buildSystemPrompt() æ„å»ºé¡ºåº:
1. CLAUDE.md (é¡¹ç›®æŒ‡ä»¤)
2. Skills (æŠ€èƒ½å†…å®¹)
3. é»˜è®¤ç³»ç»ŸæŒ‡ä»¤
4. appendPrompt (è‡ªå®šä¹‰è¿½åŠ )
```

---

## ğŸš€ å¼€å§‹é˜…è¯»å»ºè®®

### å…¥é—¨è·¯å¾„ (2 å°æ—¶)

1. **ç¬¬ä¸€æ­¥**: é˜…è¯» `package.json` å’Œ `README.md` (10 åˆ†é’Ÿ)
2. **ç¬¬äºŒæ­¥**: é˜…è¯»ç¬¬ä¸€å±‚ CLI å…¥å£å±‚ (5 åˆ†é’Ÿ)
3. **ç¬¬ä¸‰æ­¥**: é˜…è¯»ç¬¬äºŒå±‚åº”ç”¨ç¼–æ’å±‚ (15 åˆ†é’Ÿ)
4. **ç¬¬å››æ­¥**: é˜…è¯»ç¬¬ä¸‰å±‚æ ¸å¿ƒä¸šåŠ¡å±‚ (20 åˆ†é’Ÿ)
5. **ç¬¬äº”æ­¥**: é˜…è¯»ç¬¬å››å±‚ SDK é›†æˆå±‚ (10 åˆ†é’Ÿ)
6. **ç¬¬å…­æ­¥**: æµè§ˆæ‰©å±•ç³»ç»Ÿå’Œæ”¯æ’‘å±‚ (25 åˆ†é’Ÿ)
7. **ç¬¬ä¸ƒæ­¥**: è¿½è¸ªæ ¸å¿ƒæµç¨‹ 1-2 (15 åˆ†é’Ÿ)
8. **ç¬¬å…«æ­¥**: è¿è¡Œä»£ç å¹¶è°ƒè¯• (20 åˆ†é’Ÿ)

### è¿›é˜¶è·¯å¾„ (4 å°æ—¶)

1. æ·±å…¥ç ”ç©¶æ„Ÿå…´è¶£çš„æ‰©å±•ç³»ç»Ÿ (Skills/Agents/Hooks)
2. é˜…è¯»æµ‹è¯•ä»£ç ç†è§£è¾¹ç•Œæƒ…å†µ
3. ç ”ç©¶ CI/CD æ”¯æŒå’Œ Rewind æœºåˆ¶
4. å°è¯•è´¡çŒ®æ–°åŠŸèƒ½ (å‚è€ƒ CONTRIBUTING.md)

### ä»£ç å®¡æŸ¥é‡ç‚¹

å®¡æŸ¥ä»£ç æ—¶,é‡ç‚¹å…³æ³¨:
1. **ä¼šè¯ç®¡ç†**: æ˜¯å¦æ­£ç¡®ä¿å­˜/æ¢å¤ä¼šè¯?
2. **é”™è¯¯å¤„ç†**: æ˜¯å¦åˆ†ç±»é”™è¯¯å¹¶æä¾›å‹å¥½æ¶ˆæ¯?
3. **æƒé™æ£€æŸ¥**: æ˜¯å¦ç»•è¿‡æƒé™ç®¡ç†å™¨?
4. **ç±»å‹å®‰å…¨**: æ˜¯å¦ä½¿ç”¨ `@ts-expect-error` æˆ– `any`?
5. **èµ„æºæ¸…ç†**: æ˜¯å¦æ­£ç¡®æ¸…ç† AbortController/æ–‡ä»¶å¥æŸ„?

---

## ğŸ“š å‚è€ƒèµ„æº

- **Claude Agent SDK æ–‡æ¡£**: [SDK GitHub](https://github.com/anthropics/claude-agent-sdk)
- **é¡¹ç›®é…ç½®è§„èŒƒ**: `.claude/CLAUDE.md`
- **è´¡çŒ®æŒ‡å—**: `CONTRIBUTING.md`
- **æ›´æ–°æ—¥å¿—**: `CHANGELOG.md`
- **ç¤ºä¾‹é…ç½®**: `examples/`

---

**ç¥é˜…è¯»æ„‰å¿«! å¦‚æœ‰ç–‘é—®,æ¬¢è¿æ Issue æˆ– PRã€‚**
